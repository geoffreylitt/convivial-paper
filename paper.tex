% -*- coding: utf-8; -*-
% vim: set fileencoding=utf-8 :
\documentclass[english,submission]{programming}
%% First parameter: the language is 'english'.
%% Second parameter: use 'submission' for initial submission, remove it for camera-ready (see 5.1)

\usepackage{longtable,booktabs}
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\newenvironment{Shaded}{}{}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}

\usepackage[backend=biber]{biblatex}
\addbibresource{references.bib}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\begin{document}

\title{Wildcard: Spreadsheet-Driven Customization of Web Applications}
\subtitle{}% optional

\author{Geoffrey Litt}
\authorinfo{is a PhD student at MIT, researching programming tools for end users and developers.}
\author{Daniel Jackson}
\authorinfo{is a professor in the Department of Electrical Engineering and Computer Science at MIT, associate director of CSAIL, and a MacVicar Fellow. He leads the Software Design Group.}
\affiliation{Massachusetts Institute of Technology}

\keywords{end-user programming, software customization, web browser extensions} % please provide 1--5 keywords


%%%%%%%%%%%%%%%%%%
%% These data MUST be filled for your submission. (see 5.3)
\paperdetails{
  %% perspective options are: art, sciencetheoretical, scienceempirical, engineering.
  %% Choose exactly the one that best describes this work. (see 2.1)
  perspective=art,
  %% State one or more areas, separated by a comma. (see 2.2)
  %% Please see list of areas in http://programming-journal.org/cfp/
  %% The list is open-ended, so use other areas if yours is/are not listed.
  area={Programming environments, Visual and live programming},
  %% You may choose the license for your paper (see 3.)
  %% License options include: cc-by (default), cc-by-nc
  % license=cc-by-sa,
}
%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%
%% These data are provided by the editors. May be left out on submission.
%\paperdetails{
%  submitted=2016-08-10,
%  published=2016-10-11,
%  year=2016,
%  volume=1,
%  issue=1,
%  articlenumber=1,
%}
%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Please go to https://dl.acm.org/ccs/ccs.cfm and generate your Classification
% System [view CCS TeX Code] stanz and copy _all of it_ to this place.
%% From HERE
\begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10002944.10011122.10003459</concept_id>
<concept_desc>General and reference~Computing standards, RFCs and guidelines</concept_desc>
<concept_significance>300</concept_significance>
</concept>
<concept>
<concept_id>10010405.10010476.10010477</concept_id>
<concept_desc>Applied computing~Publishing</concept_desc>
<concept_significance>300</concept_significance>
</concept>
</ccs2012>
\end{CCSXML}

\ccsdesc[300]{General and reference~Computing standards, RFCs and guidelines}
\ccsdesc[500]{Applied computing~Publishing}

% To HERE
%%%%%%%%%%%%%%%%%%%%%%%

\maketitle

% Please always include the abstract.
% The abstract MUST be written according to the directives stated in 
% http://programming-journal.org/submission/
% Failure to adhere to the abstract directives may result in the paper
% being returned to the authors.
\begin{abstract}
Many Web applications do not meet the particular needs of their users.
Browser extensions and user scripts offer a way to customize web
applications, but most people do not have the programming skills to
implement their own extensions.

We present the idea of \emph{spreadsheet-driven customization}: enabling
end users to customize existing applications using a live spreadsheet
view of the data inside the application. By manipulating the
spreadsheet, users can implement a wide variety of customizations,
ranging from sorting lists of search results to displaying related data
from other web services, without doing any traditional programming.

We built a prototype system called Wildcard that implements
spreadsheet-driven customization as a web browser extension. Through
concrete examples, we demonstrate that Wildcard has both a low barrier
to entry for beginners and enough flexibility to solve many useful
problems. We also show that Wildcard can work with real existing
websites, by extracting structured data using web scraping techniques.

This paper is best viewed in the online version, which includes videos demonstrating the interface: \url{https://www.geoffreylitt.com/wildcard/}
\end{abstract}


\hypertarget{sec:introduction}{%
\section{Introduction}\label{sec:introduction}}

Web applications often don't match the particular needs of their users.
Sometimes there is a browser extension available to patch an issue, and
if the user is a programmer they might be able to fix it themselves. But
for most people, the only recourse is to complain to the developers, or
more likely, to simply give up. Back in 1977, in \emph{Personal Dynamic
Media} \autocite{kay1977}, Alan Kay envisioned personal computing as a
medium that let a user ``mold and channel its power to his own needs,''
but today, software feels more like concrete than clay.

In this paper, we present \emph{spreadsheet-driven customization}, a
technique that enables end users to customize software. The idea is to
augment an application's UI with a spreadsheet that is synchronized with
the application's data. When the user manipulates the spreadsheet, the
underlying data is modified and the changes are propagated to the UI,
and vice versa. We have implemented this technique in a prototype
browser extension called Wildcard. Section~\ref{sec:demos} presents
demos of using Wildcard to augment real websites in useful ways, and
Section~\ref{sec:implementation} describes the implementation of the
extension.

\begin{figure}
\hypertarget{fig:overview}{%
\centering
\includegraphics{media/overview-300dpi.png}
\caption{An overview of spreadsheet-driven
customization}\label{fig:overview}
}
\end{figure}

Spreadsheet-driven customization provides an easy entry point for end
users, since small tweaks can be performed with a single click. At the
same time, it also supports a variety of richer customizations, like
adding private annotations to a webpage or joining in related data from
a web API. In Section~\ref{sec:design-principles}, we elaborate on this
principle of ``low floor, high ceiling,'' as well as other design
principles guiding our work.

Prior work \autocite{mccutchen2016,benson2014,chang2014} has enabled end
users to create ``spreadsheet-driven applications'' which use
spreadsheets as a backing data layer. Spreadsheet-driven
\emph{customization} applies this idea in a different context:
customizing existing software, rather than building new software from
scratch. Our technique does not require that the application actually be
backed by a spreadsheet; it merely uses the spreadsheet as an interface
for viewing and modifying the internal state of the application.

This approach requires extracting structured data from the user
interfaces of existing applications, but we hide the complexity of data
extraction from end users. Programmers write \emph{site adapters} which
use web scraping techniques to extract structured data from existing
applications and map them to the spreadsheet table. End users only
interact with the structured spreadsheet, providing a straightforward
customization experience. In Section~\ref{sec:related-work}, we explain
this architecture in more depth, and describe how Wildcard relates to
existing work on malleable software, web customization,
spreadsheet-driven applications, and web scraping.

The Wildcard extension is currently an early research prototype. We plan
to continue testing the system with our own use cases to understand
better how well the spreadsheet abstraction maps to real websites and
customization needs. Eventually we plan to release the tool publicly, in
order to study how end users choose to customize applications, discover
usability challenges, and to test the feasibility of programmers
building and maintaining site adapters.

\hypertarget{sec:demos}{%
\section{Demo: booking a trip with Wildcard}\label{sec:demos}}

To get a sense of the user experience of using Wildcard, let's see an
example of someone using it to help with booking a trip.{ These demos
are best viewed as videos in the online version of this paper
(\url{https://www.geoffreylitt.com/wildcard}).}

\begin{figure}
\hypertarget{fig:airbnb-demo}{%
\centering
\includegraphics{media/airbnb-demo-300dpi.png}
\caption{Using Wildcard to augment the Airbnb search page for booking
accommodations}\label{fig:airbnb-demo}
}
\end{figure}

\hypertarget{customizing-search-results}{%
\subsection{Customizing search
results}\label{customizing-search-results}}

In 2012, the travel site Airbnb removed the ability to sort
accommodation listings by price. Users could still filter by price
range, but could no longer view the cheapest listings first. Many users
complained on online message boards that the change seemed hostile to
users. ``It's so frustrating!..What is the logic behind not having this
function?'' said one user on the
\href{https://community.withairbnb.com/t5/Hosting/Sorting-listing-by-price/td-p/559404}{Airbnb
support forum}. Alas, the feature remains missing to this day.

Using Wildcard, the user can fix this omission, while leaving the page's
design and the rest of its functionality unchanged.{
Figure~\ref{fig:airbnb-demo} shows an overview of augmenting the Airbnb
site.} First, the user opens up the Wildcard panel, which shows a table
corresponding to the search results in the page. As they click around in
the table, the corresponding row in the page is highlighted so they can
see the connection between the views.

Then, the user clicks on the price column header to sort the
spreadsheet, and the Airbnb UI, by in ascending order by price{
(Figure~\ref{fig:airbnb-demo}B)}. They can similarly use the column
headers to filter to listings with a user rating above 4.5, which the
original Airbnb UI also doesn't allow.

After manipulating the data, the user closes the table view and
continues using the website with its original visual design. The table
view offers a way to change the data backing a page, but does not need
to replace the original interface entirely.

Most websites that show lists of data also offer actions on rows in the
table, like adding an item to a shopping cart. Wildcard has the ability
to make these ``row actions'' available in the data table through the
site adapter.

In the Airbnb UI, saving multiple listings to a Favorites list requires
tediously clicking through them one by one. Using Wildcard, the user can
select multiple rows and favorite all of them with a single click{
(Figure~\ref{fig:airbnb-demo}D)}. Similarly, the user can also open the
detailed pages for many listings at once.

Now the user wants to jot down some notes on the pros and cons of each
listing. To do this, they type some notes into an additional column in
each listing row, and the notes appear inside the listings in the
original UI{ (Figure~\ref{fig:airbnb-demo}A)}. The annotations are saved
in the browser for future sessions.

Wildcard also includes a formula language, which enables more
sophisticated customizations that fetch external data and perform
computations.

When traveling without a car, it's useful to evaluate potential places
to stay based on how walkable the surroundings are. Using Wildcard
formulas, the user can integrate Airbnb with Walkscore, an API that
rates the walkability of any location on a 1-100 scale. When they type
in a \texttt{WALKSCORE} formula with the latitude and longitude of the
listing, it returns the walk score as the cell's value. Because the
cell's contents are injected into the page, the score also shows up in
the page body{ (Figure~\ref{fig:airbnb-demo}C)}.

\begin{figure}
\hypertarget{fig:expedia-demo}{%
\centering
\includegraphics{media/expedia-demo-300dpi.png}
\caption{Using Wildcard to augment the Expedia page for booking a
flight}\label{fig:expedia-demo}
}
\end{figure}

\hypertarget{customizing-a-form-input}{%
\subsection{Customizing a form input}\label{customizing-a-form-input}}

It might seem that Wildcard is only useful on websites that display
lists of tabular data like search results. But in fact, the table
metaphor is flexible enough to represent many types of data. For
example, a flight search form on Expedia can be represented as a single
row, with a column corresponding to each input. {
Figure~\ref{fig:expedia-demo} shows an overview of augmenting the
Expedia site.}

In previous examples the table cells were read-only; users cannot change
the name or price of an Airbnb listing. In this next case, the cells are
writable, so that changes in the table are reflected in the form inputs.
This becomes especially useful when combined with GUI widgets that can
edit the value of a table cell.

Filling in dates for a flight search typically requires opening up a
separate calendar app to find the right dates and then manually copying
them into the form. In Wildcard, the user can avoid this cumbersome
workflow by using a datepicker widget that includes the user's personal
calendar information{ (Figure~\ref{fig:expedia-demo}B)}. The user can
directly click on the right date, and it gets inserted into the
spreadsheet and the original form.

Here we've presented just a few use cases for spreadsheet-driven
customization, but we think the interactive data table is flexible
enough to support a wide range of other useful modifications, all while
remaining familiar and easy to use.

\hypertarget{sec:implementation}{%
\section{System Implementation}\label{sec:implementation}}

Wildcard is written in Typescript. It is currently injected into pages
using the \href{https://www.tampermonkey.net/}{Tampermonkey} userscript
manager, but in the future we plan to deploy it as a standalone browser
extension to make it easier to install.

In order to promote extensibility, Wildcard is implemented as a small
core program along with several types of plugins: site adapters,
formulas, and cell renderers/editors. The core contains functionality
for displaying the data table and handling user interactions, and the
table implementation is built using the
\href{https://handsontable.com/}{Handsontable} Javascript library.

\begin{figure}
\hypertarget{fig:architecture}{%
\centering
\includegraphics{media/architecture-clean.png}
\caption{The architecture of the Wildcard
system}\label{fig:architecture}
}
\end{figure}

Site adapters are a key part of Wildcard, since they specify the
bidirectional connection between the web page and its structured data
representation.

Wildcard provides an interface for concisely expressing how the DOM
should be mapped to a data table. For example, here is a code snippet
for extracting the name of an Airbnb listing:

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{\{}
  \CommentTok{// Field metadata:}
\NormalTok{  fieldName}\OperatorTok{:} \StringTok{"name"}\OperatorTok{,} \CommentTok{// The name of the field}
\NormalTok{  type}\OperatorTok{:} \StringTok{"text"}\OperatorTok{,}      \CommentTok{// The type of the field}
\NormalTok{  readOnly}\OperatorTok{:} \KeywordTok{true}\OperatorTok{,}    \CommentTok{// Whether the user can edit the field}
  
  \CommentTok{// Function to extract DOM element:}
\NormalTok{  el}\OperatorTok{:}\NormalTok{ (row) }\KeywordTok{=>} \VariableTok{row}\OperatorTok{.}\FunctionTok{querySelector}\NormalTok{(}\VerbatimStringTok{\textasciigrave{}.}\SpecialCharTok{$\{}\NormalTok{titleClass}\SpecialCharTok{\}}\VerbatimStringTok{\textasciigrave{}}\NormalTok{)}\OperatorTok{,}
\OperatorTok{\}}
\end{Highlighting}
\end{Shaded}

Sometimes important data is not shown in the UI, making it impossible to
scrape from the DOM. To address this, we have also prototyped mechanisms
for site adapters to observe AJAX requests made by the browser and
extract data directly from JSON responses. This mechanism was used to
implement the Airbnb Walkscore example, since latitude and longitude
aren't shown in the Airbnb UI, but they are available in AJAX responses.
In the future we also plan to add the ability for site adapters to
scrape data across multiple pages in paginated lists of results (as
explored in prior work \autocite{huynh2006}).

The site adapter also needs to support the reverse direction: sending
updates from the table to the original page. Most DOM manipulation is
not performed directly by the site adapter. Instead, Wildcard
automatically mutates the DOM to reflect the table state, using the same
declarative spec shown above. The only exception is row actions (like
favoriting an Airbnb listing), which are implemented as imperative
Javascript functions that can can mutate the DOM, simulate clicks on
buttons, etc.

\hypertarget{sec:design-principles}{%
\section{Design principles}\label{sec:design-principles}}

The idea of spreadsheet-driven customization is guided by several design
principles, inspired by prior work and our own experimentation. We think
these principles can also broadly inform the design of tools for end
user software customization.

\hypertarget{expose-a-universal-data-structure}{%
\subsection{Expose a universal data
structure}\label{expose-a-universal-data-structure}}

Today, most personal computing consists of using applications, which
bundle together behavior and data to provide some set of functionality.
While there are some limited points of interoperability, applications
generally are designed to operate independently of one another.

Computing does not need to be organized this way. For example, UNIX
offers a compelling alternative design: many small single-purpose
utilities, all of which manipulate a universal format of text streams.
The universal format creates a high degree of leverage from tools: users
can get a lot of utility from deeply mastering a text editor and some
text manipulation utilities, because these tools can be applied to
nearly any task. As just one example, a user's preferred text editor can
even serve as an interactive input mechanism in shell programs, e.g.~for
editing git commit messages.

Spreadsheet-driven customization aims to bring some of this UNIX ethos
to the world of isolated Web applications, by creating a consistent data
structure to represent the data inside many applications. In UNIX, the
universal format is a text stream; in Wildcard, it is a relational
table. The table is a simple abstraction which is also generic enough to
describe the data used in many different applications. Because Wildcard
maps the data from all applications to the table format, users can
invest in mastering the Wildcard table editor, the formula language, and
cell editor UIs, and reuse those same tools to customize many different
applications.

This idea relates to Beaudouin-Lafon and Mackay's notion of
\emph{polymorphic interface instruments} \autocite{beaudouin-lafon2000}:
UI elements that can be used in different contexts, like a color picker
that can be used in many different drawing applications. diSessa has
also noted the connection between literacy and the genericness of a
medium. Textual literacy rests on the fact that writing can be adapted
to many different genres and uses \autocite{disessa2000}; if people
needed to relearn reading and writing from scratch when switching from
essays to emails, the medium would lose most of its potency. We think
providing generic tools is especially important for software
customization, because the most common barrier to customizing software
is not having enough time \autocite{mackay1991}---it's more likely that
people will customize software regularly if they can reuse the same tool
across many applications.

This design principle leads to several challenges. First, any universal
abstraction has its constraints, and can't necessarily naturally express
the data in every application. We plan to explore the limits of the
table abstraction further, by trying to build adapters for more sites
with varied data formats. We expect that many types of data can fit
fairly naturally into tables: lists of search results, news articles,
and messages can all be seen as relations. On sites that use document
structures (e.g.~Google Docs) or graph structures (e.g.~social friend
graphs), it may prove more challenging to map internal data to this
abstraction.

Another challenge is ensuring a clear mapping in the user's mind between
the spreadsheet and the original page. Wildcard provides live visual
cues as the user navigates the data table (similar to the highlighting
provided by DOM inspectors in browser developer tools). In our own
usage, we have found that this live highlighting makes it very clear how
the two representations map to each other.

\hypertarget{low-floor-high-ceiling}{%
\subsection{Low floor, high ceiling}\label{low-floor-high-ceiling}}

Seymour Papert advocated for programming systems to have a ``low
floor,'' making it easy for novices to get started, and a ``high
ceiling,'' providing a large range of possibilities for more
sophisticated users \autocite{resnick2016}. Our goal is for
spreadsheet-driven customization to meet both of these criteria.

One of the most interesting properties of spreadsheets is that users who
are only know a tiny sliver of their functionality (e.g., storing tables
of numbers or computing simple sums) can still use them in genuinely
valuable ways. The fact that useful tasks can be performed early on
supports the user's natural motivation to continue using the tool, and
to eventually learn its more powerful features if needed
\autocite{nardi1991}. In contrast, many traditional programming systems
require an enormous upfront investment of time and practice before
someone is able to write a program that helps them achieve a useful task
in their life.

As part of ensuring a low floor, we have focused on including genuinely
valuable features for novices. For example, a user can sort a table with
a single click, or simply type in some annotations. We would expect many
Wildcard users to start by using these simpler features before
potentially moving on to more sophisticated features like formulas.

Another aspect of providing a low floor is providing an ``in-place
toolchain'' \autocite{inkandswitch2019}: minimizing the effort of moving
from using to customizing, by making customization tools available in
the same environment where the user is already using the software. This
quality is distinct from the level of technical skill needed to use the
tool. For example, setting up a workflow trigger in an end user
programming system like \href{https://ifttt.com/}{IFTTT} does not
require much technical skill, but does require leaving the user's normal
software and entering a separate environment; conversely, running a
Javascript snippet in the browser console requires programming skills,
but can be done immediately and casually in the flow of using a website.

\begin{longtable}[]{@{}llc@{}}
\toprule
\endhead
& \emph{In-place} & \emph{Not in-place}\tabularnewline
\emph{End user friendly} & \textbf{Wildcard} & IFTTT\tabularnewline
\emph{Requires programming} & browser JS console & forking open source
software\tabularnewline
\bottomrule
\end{longtable}

Wildcard provides an in-place toolchain because the spreadsheet can be
instantly opened in the browser window while using any supported
website. Once the user starts editing, Wildcard also provides live
feedback, so that even if a user isn't yet totally familiar with
Wildcard, they can learn to use the system through experimentation.

Since we have still only built several site adapters and demos, it is
still too early to tell exactly how high the ceiling is for the
customizations that can be achieved with Wildcard. But we think that
with enough operators, the formula language could support a wide variety
of customizations---people have managed to use simple spreadsheet
formula languages to solve a surprisingly large range of problems. We
plan to explore this aspect further by trying to solve more real
problems with the system and observing where limitations emerge in
practice.

\hypertarget{build-for-multiple-tiers-of-users}{%
\subsection{Build for multiple tiers of
users}\label{build-for-multiple-tiers-of-users}}

Real-world spreadsheet usage in offices is highly collaborative: most
users just perform simple changes, while a few coworkers help with
writing more complex formulas or even programming macros
\autocite{nardi1990}. Inspired by this collaborative approach, we aim to
make spreadsheet-driven customization a collaborative activity that
combines the different abilities of many users.

The main way we do this is by separating website customization into two
separate stages: structured data extraction, and using the resulting
spreadsheet. The data extraction stage is currently only available to
programmers who can code site adapters in Javascript, whereas the
customization stage is available to any non-programmer end user. This
architecture frees end users from needing to think about data
extraction, and enables a community of end users to reuse the efforts of
programmers building site adapters.

The group of users building adapters does not necessarily need to be
limited only to programmers. In the future, we plan to explore enabling
end users to also create site adapters, drawing on related work in this
area \autocite{chasins2018,huynh2006}. But even in that case, we still
envision a separation between highly motivated, tech-savvy end users
building adapters, and more casual end users just using the spreadsheet
view.

Another stakeholder to consider is the first party developers of the
original software. Spreadsheet-driven customization does not depend on
cooperation from first-party website developers, but if they were to
expose structured data in their web application clients, it would make
site adapters unnecessary, producing more robust results with much less
work.

We think there are compelling reasons for first parties to consider
doing this. Providing Wildcard support would allow users to build
extensions to fulfill their own feature requests. It also would not
necessarily require much effort: adding Wildcard support could be made
fairly straightforward for a first-party that already has direct access
to the structured data in the page. There is also precedent for first
parties implementing an official client extension API in response to
user demand: for several years, Google maintained an official extension
API in Gmail for Greasemonkey scripts to use.\footnote{Incidentally,
  since then, third parties have continued to maintain stable Gmail
  extension APIs used by many browser extensions
  \autocite{streak,talwar2019}, illustrating the potential of
  collaboratively maintaining third party adapters.}

\hypertarget{sec:related-work}{%
\section{Related work}\label{sec:related-work}}

\hypertarget{malleable-software}{%
\subsection{Malleable software}\label{malleable-software}}

In the broadest sense, Wildcard is inspired by systems aiming to make
software into a dynamic medium where end users frequently create and
modify software to meet their own needs, rather than only consuming
applications built by programmers. These systems include Smalltalk
\autocite{kay1977}, Hypercard \autocite{hypercard2019} , Boxer
\autocite{disessa1986}, Webstrates \autocite{klokmose2015}, and
Dynamicland \autocite{victor}.\footnote{The project's name Wildcard
  comes from the internal pre-release name for Hypercard, which doubly
  inspired our work by promoting both software modification by end users
  and the ideas behind the Web.}

While similar in broad goals, Wildcard employs a different solution
strategy. These projects generally require building software from
scratch in a new environment, whereas Wildcard aims to maximize the
malleability of software built with existing tools. This approach has
the pragmatic benefit of enabling customization for much more software,
although it also imposes more rigid constraints.

With substantial future work, we think Wildcard could become more
similar to these other projects, growing from a platform for tweaking
existing software into a platform for building new software from
scratch. This would likely end up resembling existing tools for building
spreadsheet-driven applications (discussed more below), but with an
additional focus on customizability by end users of the software.

\hypertarget{web-customization}{%
\subsection{Web customization}\label{web-customization}}

Wildcard's goals are closely shared with other systems that provide
interfaces in the browser for end users to augment and customize
websites while using them.

\hypertarget{structured-augmentation}{%
\subsubsection{Structured augmentation}\label{structured-augmentation}}

Wildcard's solution approach is most similar to other tools that
identify structured data in a web page, and then use that structure to
support end user customization of the page.

Sifter \autocite{huynh2006} enables users to sort and filter lists of
data on web pages, which resembles Wildcard's sort and filter
functionality. The underlying mechanism is also similar, since Sifter
extracts structured data from the page to enable its user-facing
functionality. The systems also have major differences. Wildcard aims to
extend this approach to support much broader functionality, and shows
the structured data table directly to the user. In contrast, Sifter only
supports sorting and filtering, and does not reveal the underlying data
table. The extraction mechanism is also different: Sifter uses a
combination of automated heuristics and interactive user feedback to
enable end users to extract data, whereas Wildcard hides data extraction
from end users.

Thresher \autocite{hogue2005} enables users to create wrappers which map
unstructured website content to Semantic Web content. Like Wildcard and
Sifter, Thresher augments the experience of original page based on
identifying structure; once semantic content has been identified, it
creates context menus in the original website which allow users to take
actions based on that content. Wildcard and Thresher focus on
complementary parts of the problem. Thresher aims to enable end users to
create content wrappers, but the actions available on the structured
data are created by programmers; conversely, Wildcard delegates wrapper
creation to programmers but gives end users more flexibility to use the
structured data in an open-ended way.

\hypertarget{sloppy-augmentation}{%
\subsubsection{Sloppy augmentation}\label{sloppy-augmentation}}

``Sloppy programming'' \autocite{little2010} tools like Chickenfoot
\autocite{bolin2005} and Coscripter \autocite{leshed2008} enable users
to create scripts that perform actions like filling in text boxes and
clicking buttons, without directly interacting with the DOM. Users
express the desired page elements in natural, informal terms
(e.g.~writing ``the username box'' to represent the textbook closest to
the label ``username''), and then using heuristics to determine which
elements most likely match the user's intent. This approach allows for
expressing a wide variety of commands with minimal training, but it also
has downsides \autocite{little2010}:

\begin{itemize}
\tightlist
\item
  Reliability: It can be difficult to know whether a command will
  consistently work over time. In addition to changes to the website,
  changes to the heuristics can also cause problems.
\item
  Discoverability: it can be difficult for users to discover the space
  of possible commands.
\end{itemize}

Wildcard offers a sharp contrast to sloppy programming, instead choosing
to expose a high degree of structure through the familiar spreadsheet
table. Wildcard offers more consistency; for example, clicking a sort
header will always work correctly as long as the site adapter is
maintained. Wildcard also offers clearer affordances for what types of
actions are possible, or, crucially, what actions are \emph{not}
possible, which is useful to know. On the other hand, Wildcard's
explicit site adapter approach will result in coverage of many fewer
websites, and also a narrower range of possible actions than ``sloppy''
tools.

\hypertarget{spreadsheet-based-app-builders}{%
\subsection{Spreadsheet-based app
builders}\label{spreadsheet-based-app-builders}}

Many others have made the powerful realization that a spreadsheet can
serve as an backing data store and computation layer for an interactive
web application, enabling end users to create such applications more
easily. Research projects like Object Spreadsheets
\autocite{mccutchen2016}, Quilt \autocite{benson2014}, Gneiss
\autocite{chang2014}, and Marmite \autocite{wong2007}, as well as
commercial tools like Airtable Blocks \autocite{zotero-79} and Glide
\autocite{zotero-81} allow users to view data in a spreadsheet table,
compute over the data using formulas, and then connect the table to a
GUI. Because many users are already familiar with using spreadsheets,
this way of creating applications tends to be much easier than
traditional software methods; for example, in a user study of Quilt,
many users were able to create applications in under 10 minutes, even if
they expected it would take them many hours.

Wildcard builds on this idea, but applies it to modifying existing
applications, rather than building new applications from scratch. For
many people, we suspect that tweaking existing applications provides
more motivation as a starting point for programming than creating a new
application from scratch.

An important design decision for tools in this space is how to deviate
from traditional spreadsheets like Microsoft Excel or Google Sheets.
Quilt and Glide use existing spreadsheet software as a backend,
providing maximum familiarity for users, and even compatibility with
existing spreadsheets. Gneiss has its own spreadsheet implementation
with additional features useful for building GUIs. Marmite provides a
live data view that resembles a spreadsheet, but programming is actually
done using a separate data flow pane rather than spreadsheet formulas.
(Marmite's approach led to some confusion in a user study, because users
expected behavior more similar to spreadsheets \autocite{wong2007}.)
Airtable deviates the furthest: although the user interface resembles a
spreadsheet, the underlying structure is a relational database with
typed columns. Wildcard's table is most similar to Airtable; the
structure of a relational table is most appropriate for most data in
websites, and we have not yet found a need for arbitrary untyped cells.

\hypertarget{web-scraping-data-extraction}{%
\subsection{Web scraping / data
extraction}\label{web-scraping-data-extraction}}

Web scraping tools focus on extracting structured data out of
unstructured web pages. Web scraping is closely related to the
implementation of Wildcard, but has different end goals: web scraping
generally extracts static data for processing in another environment,
whereas Wildcard customizes the application's UI by maintaining a
bidirectional connection between the extracted data and the page.

Web scraping tools differ in how much structure they attempt to map onto
the data. Some tools like Rousillon \autocite{chasins2018} extract data
in a minimally structured relational format; other tools like Piggy Bank
\autocite{huynh2005} more ambitiously map the data to a rich semantic
schema. In Wildcard, we chose to avoid schemas, in order to minimize the
work associated with creating a site adapter.

In the future, we might be able to integrate web scraping tools to help
create more reliable site adapters for Wildcard with less work, and to
open up adapter creation to end users. Sifter was built on top of the
Piggy Bank scraping library, suggesting precisely this type of
architecture where web scraping tools are used to support interactive
page modification.

\hypertarget{future-work}{%
\section{Future work}\label{future-work}}

There are still many open questions about spreadsheet-driven
customization which we hope to answer through targeted development and
usage of the Wildcard prototype.

The most important question is: where are the limits of this
computational model? What types of useful customizations can it support
or not support? While initial demos suggest a variety of use cases, we
plan to develop more site adapters and demos to explore this question
further. We will start with privately testing the system with our own
needs, and then eventually deploy the tool publicly, once the API is
stable enough and can support a critical mass of sites and use cases. We
also plan to run usability studies to evaluate and improve the design of
the tool.

We suspect that two areas of the current model may prove limiting.
First, Wildcard's data model currently shows a single table at a time,
without any notion of relationships between tables. A richer data model
with foreign keys might help support certain use cases. For designing a
spreadsheet interface on top of a richer relational model, we could
learn from other systems with this design
\autocite{mccutchen2016,bakke2016}.

A second potential limitation is that there is currently no mechanism
for end users to express imperative workflows with sequences of actions,
which related work has shown to be useful
\autocite{bolin2005,leshed2008}. It's not clear how such workflows could
fit into Wildcard, since spreadsheets have a fundamentally different
computation model, and site adapters created by programmers cannot
easily account for every possible action a user would want to take in a
page.

Another open question is how efficiently site adapters can be created
for real websites, which often include complex markup. We plan to
explore this question by creating adapters for sites with different data
structures and in different domains, and perhaps running user tests with
programmers. Possible future improvements we've considered include
developing automated heuristics to assist with the adapter creation
process, and developing new abstractions that make it easier for
programmers to efficiently create new robust adapters.

\hypertarget{conclusion}{%
\section{Conclusion}\label{conclusion}}

In this paper, we have presented \emph{spreadsheet-driven
customization}, a technique that enables end users to customize software
by augmenting an application's UI with a spreadsheet. We hope that this
technique contributes to making the Web into a more dynamic medium that
users can mold to their own needs.

We plan to continue developing the Wildcard prototype and to eventually
deploy it as an open-source tool. To receive future updates on Wildcard
and notifications about a public release, \href{}{sign up for the email
newsletter}.

We are also looking for private beta testers. If you have an idea for
how you might want to use Wildcard, please
\href{mailto:glitt@mit.edu}{get in touch}. We would love to hear about
your needs and help find ways to use Wildcard to solve them.

\acks
Thank you to Glen Chiacchieri, Steve Krouse, Daniel Windham, and Maggie
Yellen for providing helpful feedback on this work.

\printbibliography

\end{document}

% Local Variables:
% TeX-engine: luatex
% End:
